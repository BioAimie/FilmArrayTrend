index <- which(g2$layout$name == "ylab-l") # Which grob contains the y axis title?
ylab <- g2$grobs[[index]]                # Extract that grob
ylab <- hinvert_title_grob(ylab)         # Swap margins and fix justifications
# Put the transformed label on the right side of g1
g1 <- gtable_add_cols(g1, g2$widths[g2$layout[index, ]$l], pp$r)
g1 <- gtable_add_grob(g1, ylab, pp$t, pp$r + 1, pp$b, pp$r + 1, clip = "off", name = "ylab-r")
# Get the y axis from g2 (axis line, tick marks, and tick mark labels)
index <- which(g2$layout$name == "axis-l")  # Which grob
yaxis <- g2$grobs[[index]]                  # Extract the grob
# First, move the axis line to the left
yaxis$children[[1]]$x <- unit.c(unit(0, "npc"), unit(0, "npc"))
# Second, swap tick marks and tick mark labels
ticks <- yaxis$children[[2]]
ticks$widths <- rev(ticks$widths)
ticks$grobs <- rev(ticks$grobs)
# Third, move the tick marks
ticks$grobs[[1]]$x <- ticks$grobs[[1]]$x - unit(1, "npc") + unit(3, "pt")
# Fourth, swap margins and fix justifications for the tick mark labels
ticks$grobs[[2]] <- hinvert_title_grob(ticks$grobs[[2]])
# Fifth, put ticks back into yaxis
yaxis$children[[2]] <- ticks
# Put the transformed yaxis on the right side of g1
g1 <- gtable_add_cols(g1, g2$widths[g2$layout[index, ]$l], pp$r)
iliBestCor <- gtable_add_grob(g1, yaxis, pp$t, pp$r + 1, pp$b, pp$r + 1, clip = "off", name = "axis-r")
# Draw it
grid.newpage()
grid.draw(iliBestCor)
grid.newpage()
png('Figures/BestCorrelatedSummedPrevalenceWithILI.png', height=800, width=1400)
grid.draw(iliBestCor)
dev.off()
head(cor.prev)
head(cor.count)
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCorCombo==max(multiple.var.cor.count$BestCorCombo), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCorCombo==max(multiple.var.cor.count$BestCorCombo), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
multiple.var.cor.count[multiple.var.cor.count$BestCorCombo==max(multiple.var.cor.count$BestCorCombo), 'BestCorCombo']
multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels)
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName, order=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName, order=ShortName), stat='identity', position='stack') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='', x='Date')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName, order=ShortName), stat='identity', position='stack')
head(cor.count)
cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ]
head(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ])
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek, y=Positives, fill=ShortName)) + geom_bar(stat='identity')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek, y=Positives, fill=ShortName)) + geom_area(stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek, y=Positives, fill=ShortName)) + geom_area(aes(x=YearWeek, y=Positives, fill=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(x=YearWeek, y=Positives, fill=ShortName), stat='identity', position='stack')
a <- cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ]
head(a)
ggplot(a, aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), data=a)
ggplot(a, aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName))
ggplot(cor.count[cor.count$Name %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Prevalence, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$Name %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=aggregate(cor.count$Runs~cor.count$YearWeek, FUN=mean), size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=aggregate(cor.count$Runs~cor.count$YearWeek, FUN=mean), size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count[cor.count$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count, 'ShortName'), name='') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
head(cor.count)
head(cor.count.agg)
head(cor.count.agg)
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count.agg[multiple.var.cor.count.agg$BestCor==max(multiple.var.cor.count.agg$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack')
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count.agg[multiple.var.cor.count.agg$BestCor==max(multiple.var.cor.count.agg$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_bar(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE))
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank(), axis.tick.y=element_blank(), axis.text.y=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', x='Date', y='')
ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', x='Date', y='')
p.BestCorrelatedSummedPrevalenceWithTUR <- ggplot(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', x='Date', y='')
p.TUR_NoYAxis
grid.newpage()
png('Figures/BestCorrelatedSummedPrevalenceWithILI.png', height=800, width=1400)
grid.draw(iliBestCor)
dev.off()
plots <- ls()[grep('^p\\.',ls())]
for(i in 1:length(plots)) {
imgName <- paste(substring(plots[i],3),'.png',sep='')
png(file=paste('Figures', imgName, sep='/'), width=1200, height=800, units='px')
print(eval(parse(text = plots[i])))
dev.off()
}
library(RODBC)
library(lubridate)
library(EpiWeek)
library(ggplot2)
library(grid)
library(gridExtra)
library(scales)
library(gtable)
library(RColorBrewer)
library(devtools)
library(RCurl)
library(binom)
library(caret)
library(rpart)
library(party)
library(partykit)
library(randomForest)
library(dplyr)
library(tidyr)
require(dateManip)
p.InfluezaPrevalencePercentDetectionNoILI
plots
head(public.health.flu)
head(prev.reg.ph.flu)
head(prev.nat.ph.flu)
max(prev.nat.ph.flu$FlAH3)
max(prev.nat.ph.flu$FluAH109)
max(prev.nat.ph.flu$FluB)
head(public.health.flu)
public.health.flu <- read.csv('../DataSources/RegionalInfluenzaBySubType_PublicHealthLabs.csv', header=TRUE, sep=',')
public.health.flu <- data.frame(Region = public.health.flu$REGION, YearWeek = ifelse(public.health.flu$WEEK < 10, paste(public.health.flu$YEAR, public.health.flu$WEEK, sep='-0'), paste(public.health.flu$YEAR, public.health.flu$WEEK, sep='-')), TotalPatients = public.health.flu$TOTAL.SPECIMENS, FluAH109 = public.health.flu$A..2009.H1N1., FlAH3 = public.health.flu$A..H3., FluANoSubtype = public.health.flu$A..Subtyping.not.Performed., FluB = public.health.flu$B)
prev.reg.wrap <- merge(prevalence.reg.wrap, unique(runs.reg[,c('CustomerSiteId','Region')]), by='CustomerSiteId')
public.health.flu <- public.health.flu[public.health.flu$Region %in% unique(prev.reg.wrap$Region), ]
regions <- as.character(unique(public.health.flu$Region))
yearweeks <- as.character(unique(public.health.flu$YearWeek))
public.health.flu <- do.call(rbind, lapply(1:length(regions), function(x) do.call(rbind, lapply(2:(length(yearweeks)-1), function(y) data.frame(YearWeek = yearweeks[y], Region = regions[x], TotalPatients = sum(filter(public.health.flu, Region==regions[x])[, 'TotalPatients'][(y-1):(y+1)]), FluAH109 = sum(filter(public.health.flu, Region==regions[x])[, 'FluAH109'][(y-1):(y+1)]), FlAH3 = sum(filter(public.health.flu, Region==regions[x])[, 'FlAH3'][(y-1):(y+1)]), FluANoSubtype = sum(filter(public.health.flu, Region==regions[x])[, 'FluANoSubtype'][(y-1):(y+1)]), FluB = sum(filter(public.health.flu, Region==regions[x])[, 'FluB'][(y-1):(y+1)]))))))
head(public.health.flu)
head(prev.reg.wrap)
prev.reg.ph.flu <- merge(prev.reg.wrap, public.health.flu, by=c('YearWeek','Region'))
prev.reg.ph.flu$FluAH109 <- with(prev.reg.ph.flu, FluAH109/TotalPatients)
prev.reg.ph.flu$FlAH3 <- with(prev.reg.ph.flu, FlAH3/TotalPatients)
prev.reg.ph.flu$FluANoSubtype <- with(prev.reg.ph.flu, FluANoSubtype/TotalPatients)
prev.reg.ph.flu$FluB <- with(prev.reg.ph.flu, FluB/TotalPatients)
head(prev.reg.ph.flu)
max(prev.reg.ph.flu$FluAH109)
max(prev.reg.ph.flu$FluB)
max(prev.reg.ph.flu$FlAH3)
hist(prev.reg.ph.flu$FlAH3)
hist(prev.reg.ph.flu$FluAH109)
prev.reg.ph.flu <- merge(prev.reg.wrap, public.health.flu, by=c('YearWeek','Region'))
prev.reg.ph.flu$FluAH109 <- with(prev.reg.ph.flu, FluAH109/TotalPatients)
prev.reg.ph.flu$FlAH3 <- with(prev.reg.ph.flu, FlAH3/TotalPatients)
prev.reg.ph.flu$FluANoSubtype <- with(prev.reg.ph.flu, FluANoSubtype/TotalPatients)
prev.reg.ph.flu$FluB <- with(prev.reg.ph.flu, FluB/TotalPatients)
prev.nat.ph.flu <- with(prev.reg.ph.flu, aggregate(cbind(Prevalence, Rate, FluAH109, FlAH3, FluANoSubtype, FluB)~YearWeek+ShortName, FUN=mean))
ggplot(subset(prev.nat.ph.flu, ShortName=='FluA H1-09'), aes(x=YearWeek, y=4*Prevalence, group='FilmArray Percent Detection of FluA H1-09', color='FilmArray Percent Detection of FluA H1-09')) + geom_line(lwd=2) + geom_line(aes(x=YearWeek, y=FluAH109, group='CDC Reported Rate of FluA H1-09', color='CDC Reported Rate of FluA H1-09'), data=prev.nat.ph.flu, lwd=2) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(limits=c(0,0.6), breaks=c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6), labels=c('10','20','30','40','50','60')) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='CDC Reported Detection (%)', x='Date')
head(public.health.flu)
ggplot(public.health.flu, aes(x=YearWeek, y=TotalPatients, fill=Region)) + geom_bar(stat='identity')
head(prev.reg.ph.flu)
head(public.health.flu)
public.health.flu[public.health.flu$TotalPatients < 10, ]
public.health.flu[public.health.flu$TotalPatients < 30, ]
unique(public.health.flu$Region)
as.character(unique(public.health.flu$Region))
hist(public.health.flu$TotalPatients)
hist(public.health.flu$TotalPatients, breaks = seq(1, 4000, 10))
hist(public.health.flu$TotalPatients, breaks = seq(1, 4000, 30))
overlay.fluAH109
grid.newpage()
grid.draw(overlay.fluAH109)
ggplot(subset(prev.nat.ph.flu, ShortName=='FluA H3'), aes(x=YearWeek, y=Prevalence, group='FilmArray Percent Detection of FluA H3', color='FilmArray Percent Detection of FluA H3')) + geom_line(lwd=2) + geom_line(aes(x=YearWeek, y=FlAH3, group='CDC Reported Rate of FluA H3', color='CDC Reported Rate of FluA H3'), data=prev.nat.ph.flu, lwd=2) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(limits=c(0,0.6), breaks=c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6), labels=c('10','20','30','40','50','60')) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='CDC Reported Detection (%)', x='Date')
head(cdc.bfdx.flu.nat)
grid.newpage()
png('Figures/FluAH109PercentDetectionWithOverlay.png', height=800, width=1400)
grid.draw(overlay.fluAH109)
dev.off()
grid.newpage()
png('Figures/FluAH3PercentDetectionWithOverlay.png', height=800, width=1400)
grid.draw(overlay.fluAH3)
dev.off()
grid.newpage()
png('Figures/FluBPercentDetectionWithOverlay.png', height=800, width=1400)
grid.draw(overlay.fluB)
dev.off()
head(cdc.bfdx.flu.nat)
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)
attributes(ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection))
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$lag
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$acf
decoder
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)
acf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$acf
attributes(ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection))
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$n.used
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$n.lag
ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$lag
data.frame(Lag = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$lag, CCF = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$acf)
ccf.frame <- data.frame(Lag = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$lag, CCF = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$acf)
ccf.chart <- ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)
ccf.frame <- data.frame(Lag = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$lag, CCF = ccf(cdc.bfdx.flu.nat$FluPrevalence, cdc.bfdx.flu.nat$FluPercentDetection)$acf)
ccf.frame
# load libraries
library(RODBC)
library(lubridate)
library(EpiWeek)
library(ggplot2)
library(grid)
library(gridExtra)
library(scales)
library(gtable)
library(RColorBrewer)
library(devtools)
library(RCurl)
library(binom)
library(caret)
library(rpart)
library(party)
library(partykit)
library(randomForest)
library(dplyr)
library(tidyr)
require(dateManip)
head(prev.nat.ph.flu)
with(subset(prev.nat.ph.flu, ShortName=='FluA'))
as.character(unique(prev.nat.ph.flu$ShortName))
with(subset(prev.nat.ph.flu, ShortName=='FluA H3'), cor(FlAH3, Prevalence))
with(subset(prev.nat.ph.flu, ShortName=='FluA H3'), ccf(FlAH3, Prevalence))
fluAH3.cor <- with(subset(prev.nat.ph.flu, ShortName=='FluA H3'), cor(FlAH3, Prevalence))
fluAH3.ccf <- with(subset(prev.nat.ph.flu, ShortName=='FluA H3'), ccf(FlAH3, Prevalence))
data.frame(Lag = fluAH3.ccf$lag, CCF = fluAH3.ccf$acf)
fluAH3.ccf.df <- data.frame(Lag = fluAH3.ccf$lag, CCF = fluAH3.ccf$acf)
fluAH3.ccf.df[fluAH3.ccf.df$CCF==max(fluAH3.ccf.df$CCF), ]
as.character(unique(prev.nat.ph.flu$ShortName))
head(prev.nat.ph.flu)
FluAH109.cor <- with(subset(prev.nat.ph.flu, ShortName=='FluA H1-09'), cor(FluAH109, Prevalence))
FluAH109.ccf <- with(subset(prev.nat.ph.flu, ShortName=='FluA H1-09'), ccf(FluAH109, Prevalence))
FluAH109.ccf.df <- data.frame(Lag = FluAH109.ccf$lag, CCF = FluAH109.ccf$acf)
FluAH109.ccf.df[FluAH109.ccf.df$CCF==max(FluAH109.ccf.df$CCF), ]
FluAH109.cor
FluB.cor <- with(subset(prev.nat.ph.flu, ShortName=='FluB'), cor(FluB, Prevalence))
FluB.ccf <- with(subset(prev.nat.ph.flu, ShortName=='FluB'), ccf(FluB, Prevalence))
FluB.ccf.df <- data.frame(Lag = FluB.ccf$lag, CCF = FluB.ccf$acf)
FluB.ccf.df[FluB.ccf.df$CCF==max(FluB.ccf.df$CCF), ]
FluB.cor
ccf.frame
with(cdc.bfdx.flu.nat, cor(FluPrevalence, FluPercentDetection))
ccf.frame[ccf.frame$CCF==max(ccf.frame$CCF), ]
FluB.ccf.df[FluB.ccf.df$CCF==max(FluB.ccf.df$CCF), ]
head(cor.count.agg)
ggplot(cor.prev[cor.prev$Name %in% strsplit(as.character(multiple.var.cor[multiple.var.cor$BestCorILI==max(multiple.var.cor$BestCorILI), 'BestCorComboILI']), split = ', ')[[1]], ], aes(x=YearWeek)) + geom_area(aes(y=Prevalence, fill=Name, group=Name), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.prev, 'Name'), name='') + geom_line(aes(x=YearWeek, y=6*Rate, group='ILI', color='ILI'), data=cor.prev, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', y='FilmArray Percent Detection (%)', x='Date') + scale_y_continuous(limits=c(0, 0.3), breaks=c(0.0,0.05,0.1,0.15,0.2,0.25,0.3), labels=c('0','5','10','15','20','25','30'))
multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), c('VariableCount','BestCorCombo','BestCor')]
head(cor.count.agg)
head(single.var.cor.count)
head(cor.count.agg)
head(multiple.var.cor.count)
cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ]
head(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ])
with(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aggregate(Positives~YearWeek, FUN=sum))
pos.count <- with(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aggregate(Positives~YearWeek, FUN=sum))
run.count <- with(cor.count.agg[cor.count.agg$ShortName %in% strsplit(as.character(multiple.var.cor.count[multiple.var.cor.count$BestCor==max(multiple.var.cor.count$BestCor), 'BestCorCombo']), split = ', ')[[1]], ], aggregate(Runs~YearWeek, FUN=mean))
head(pos.count)
head(run.count)
run.pos.count <- merge(run.count, pos.count, by='YearWeek')
with(run.pos.count, cor(Runs, Positives))
with(run.pos.count, ccf(Runs, Positives))
tur.summed.cor <- with(run.pos.count, cor(Runs, Positives))
tur.summed.ccf <- with(run.pos.count, ccf(Runs, Positives))
tur.summed.ccf.df <- data.frame(Lag = tur.summed.ccf$lag, CCF = tur.summed.ccf$acf)
tur.summed.ccf.df[tur.summed.ccf.df$CCF==max(tur.summed.ccf.df$CCF), ]
ccf.frame[ccf.frame$CCF==max(ccf.frame$CCF), ]
with(subset(prev.nat.ph.flu, ShortName=='FluA H1-09'), cor(FluAH109, Prevalence))
FluAH109.ccf.df[FluAH109.ccf.df$CCF==max(FluAH109.ccf.df$CCF), ]
with(subset(prev.nat.ph.flu, ShortName=='FluA H3'), cor(FlAH3, Prevalence))
fluAH3.ccf.df[fluAH3.ccf.df$CCF==max(fluAH3.ccf.df$CCF), ]
with(subset(prev.nat.ph.flu, ShortName=='FluB'), cor(FluB, Prevalence))
FluB.ccf.df[FluB.ccf.df$CCF==max(FluB.ccf.df$CCF), ]
data.frame(Lag = FluB.ccf$lag, CCF = FluB.ccf$acf)
with(run.pos.count, cor(Runs, Positives))
tur.summed.ccf.df[tur.summed.ccf.df$CCF==max(tur.summed.ccf.df$CCF), ]
library(RODBC)
library(lubridate)
library(EpiWeek)
library(ggplot2)
library(grid)
library(gridExtra)
library(scales)
library(gtable)
library(RColorBrewer)
library(devtools)
library(RCurl)
library(binom)
library(caret)
library(rpart)
library(party)
library(partykit)
library(randomForest)
library(dplyr)
library(tidyr)
require(dateManip)
ggplot(cor.count.agg, aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', x='Date', y='')
p.AllSummedPrevalenceWithTUR <- ggplot(cor.count.agg, aes(x=YearWeek)) + geom_area(aes(y=Positives, fill=ShortName, group=ShortName), stat='identity', position='stack') + scale_fill_manual(values=createPaletteOfVariableLength(cor.count.agg, 'ShortName'), name='') + geom_line(aes(x=YearWeek, y=Runs, group='TUR', color='TUR'), data=cor.count.agg, size=1.5, color='black') + scale_x_discrete(breaks=dateBreaks, labels=dateLabels) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='white', fill='white'), axis.ticks.x=element_blank(), axis.ticks.y=element_blank(), axis.text.y=element_blank()) + guides(fill=guide_legend(ncol=7, bycol=TRUE)) + labs(title='', x='Date', y='')
library(RODBC)
library(lubridate)
library(EpiWeek)
library(ggplot2)
library(grid)
library(gridExtra)
library(scales)
library(gtable)
library(RColorBrewer)
library(devtools)
library(RCurl)
library(binom)
library(caret)
library(rpart)
library(party)
library(partykit)
library(randomForest)
library(dplyr)
library(tidyr)
require(dateManip)
ggplot(prev.pareto.all.duals, aes(x=Name, y=Prevalence, fill='Percent Detection')) + geom_bar(stat='identity') + scale_fill_manual(values=c('grey','transparent'), guide=FALSE) + geom_point(aes(x=Name, y=PercentOfDetectionsWithACo/4, color='Percent of Detections with a Co-Detection Present'), data=prev.pareto.all.duals, size=4, color='black') + scale_y_continuous(limits=c(0,0.25), breaks=c(0,0.05,0.10,0.15,0.20,0.25), labels=c('0','5','10','15','20','25')) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(y='Detection (%)', x='')
head(prev.pareto.all.duals)
grid.newpage()
grid.draw(paretoCoDets2)
head(prev.pareto.all.duals)
hist(prev.pareto.all.duals$PercentOfDetectionsWithACo)
ggplot(prev.pareto.all.duals$PercentOfDetectionsWithACo, aes(x=PercentOfDetectionWithACo)) + geom_histogram()
ggplot(prev.pareto.all.duals$PercentOfDetectionsWithACo) + geom_histogram(aes(x=PercentOfDetectionWithACo))
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionWithACo)) + geom_histogram()
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionsWithACo)) + geom_histogram()
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionsWithACo)) + geom_histogram(binwidth=0.1)
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionsWithACo)) + geom_histogram(binwidth=0.05)
head(prev.pareto.all.duals)
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05)
ggplot(prev.pareto.all.duals, aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05, limits=c(0,0.6))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.8), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal)
head(prevalence.reg.count)
unique(prevalence.reg.count$CustomerSiteId)
sites
head(runs.df)
unique(runs.df$CustomerSiteId)
unique(runs.df$CustomerSiteId)[order(unique(runs.df$CustomerSiteId))]
unique(prevalence.reg.count$CustomerSiteId)[order(unique(prevalence.reg.count$CustomerSiteId))]
head(cdc.bfdx.flu.reg)
ggplot(cdc.bfdx.flu.reg, aes(x=YearWeek, y=FluPrevalence, group=Region)) + geom_line() + geom_line(data=cdc.bfdx.flu.reg, aes(x=YearWeek, y=FluPercentDetection, group=Region)) + facet_wrap(~Region)
ggplot(cdc.bfdx.flu.reg, aes(x=YearWeek, y=FluPrevalence, group=Region)) + geom_line(color='blue') + geom_line(data=cdc.bfdx.flu.reg, aes(x=YearWeek, y=FluPercentDetection, group=Region), color='black') + facet_wrap(~Region)
head(bfdx.flu.reg)
bfdx.flu.reg[bfdx.flu.reg$Runs < 30, ]
bfdx.flu.reg[bfdx.flu.reg$Runs < 50, ]
bfdx.flu.reg[bfdx.flu.reg$Region=='Pacific', ]
head(cdc.bfdx.flu.reg)
head(bfdx.flu.reg)
cdc.bfdx.flu.nat <- with(cdc.bfdx.flu.reg, aggregate(cbind(FluPrevalence, FluPercentDetection)~YearWeek, FUN=median))
cdc.bfdx.flu.nat <- merge(cdc.bfdx.flu.nat, unique(prevalence.nat.individual.wrap[,c('YearWeek','Rate')]), by='YearWeek')
cdc.bfdx.flu.nat <- merge(cdc.bfdx.flu.nat, ili.burn.nat[,c('YearWeek','NormalizedBurn')], by='YearWeek')
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5)  + geom_line(aes(x=YearWeek, y=8*Rate, group='CDC ILI Rate', color='CDC ILI Rate'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
cdc.bfdx.flu.nat <- with(cdc.bfdx.flu.reg, aggregate(cbind(FluPrevalence, FluPercentDetection)~YearWeek, FUN=mean))
cdc.bfdx.flu.nat <- merge(cdc.bfdx.flu.nat, unique(prevalence.nat.individual.wrap[,c('YearWeek','Rate')]), by='YearWeek')
cdc.bfdx.flu.nat <- merge(cdc.bfdx.flu.nat, ili.burn.nat[,c('YearWeek','NormalizedBurn')], by='YearWeek')
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5)  + geom_line(aes(x=YearWeek, y=8*Rate, group='CDC ILI Rate', color='CDC ILI Rate'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
head(bfdx.flu.reg)
bfdx.flu.reg.agg <- with(bfdx.flu.reg, aggregate(cbind(Runs, FluDetections)~YearWeek+Region, FUN=sum))
head(cdc.flu.reg)
cdc.bfdx.flu.agg <- merge(cdc.flu.reg, bfdx.flu.reg.agg, by=c('YearWeek','Region'))
head(cdc.bfdx.flu.agg)
cdc.bfdx.flu.agg$FluPrevalence <- with(cdc.bfdx.flu.agg, TotalFluObservations/TotalPatients)
cdc.bfdx.flu.agg$FluPercentDetection <- with(cdc.bfdx.flu.agg, FluDetections/Runs)
cdc.bfdx.flu.agg <- with(cdc.bfdx.flu.agg, aggregate(cbind(FluPrevalence, FluPercentDetection)~YearWeek, FUN=mean))
head(cdc.bfdx.flu.nat)
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5)  + geom_line(aes(x=YearWeek, y=8*Rate, group='CDC ILI Rate', color='CDC ILI Rate'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
# load libraries
library(RODBC)
library(lubridate)
library(EpiWeek)
library(ggplot2)
library(grid)
library(gridExtra)
library(scales)
library(gtable)
library(RColorBrewer)
library(devtools)
library(RCurl)
library(binom)
library(caret)
library(rpart)
library(party)
library(partykit)
library(randomForest)
library(dplyr)
library(tidyr)
require(dateManip)
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5)  + geom_line(aes(x=YearWeek, y=8*Rate, group='CDC ILI Rate', color='CDC ILI Rate'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(cdc.bfdx.flu.agg, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(cdc.bfdx.flu.nat, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(cdc.bfdx.flu.agg, aes(x=YearWeek, y=FluPercentDetection, group='FilmArrary Detection', color='FilmArray Detection')) + geom_line(size=2) + geom_line(aes(x=YearWeek, y=FluPrevalence, group='CDC Flu Prevalence', color='CDC Flu Prevalence'), cdc.bfdx.flu.nat, lwd=1.5) + scale_color_manual(values=c('black','blue','red','darkgreen'), name='') + scale_y_continuous(breaks=c(0,.07,0.14,0.21,0.28,0.35), limits=c(0,0.35), labels=c(0, 7, 14, 21, 28, 35)) + scale_x_discrete(breaks = dateBreaksAlt2, labels = dateLabelsAlt2) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank(), axis.ticks.x=element_blank()) + labs(y='FilmArray Detection (%), Flu Prevalence (%)', x='Date')
ggplot(coParticipation.DetectionCount.fillByCount, aes(x=Name, y=Percentage, fill=Key)) + geom_bar(stat='identity') + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.35), panel.background=element_rect(color='white', fill='white')) + scale_fill_manual(values=createPaletteOfVariableLength(coParticipation.DetectionCount.fillByCount, 'Key'), name='') + scale_y_continuous(limits=c(0,0.25), breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3), labels=c('0','5','10','15','20','25','30')) + labs(x='', y='Detection (%)')
ggplot(subset(coParticipation.DetectionCount.fillByCount, !(ShortName %in% c('HRV/EV','RSV'))), aes(x=Name, y=Percentage, fill=Key)) + geom_bar(stat='identity') + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.35), panel.background=element_rect(color='white', fill='white')) + scale_fill_manual(values=createPaletteOfVariableLength(coParticipation.DetectionCount.fillByCount, 'Key'), name='') + scale_y_continuous(limits=c(0,0.10), breaks=c(0,0.025,0.05,0.075,0.10), labels=c('0.0','2.5','5.0','7.5','10.0')) + labs(x='', y='Detection (%)')
ggplot(subset(coParticipation.DetectionCount.fillByCount, !(ShortName %in% c('HRV/EV','RSV'))), aes(x=Name, y=Percentage, fill=Key)) + geom_bar(stat='identity') + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.35), panel.background=element_rect(color='white', fill='white')) + scale_fill_manual(values=createPaletteOfVariableLength(coParticipation.DetectionCount.fillByCount, 'Key'), name='') + scale_y_continuous(limits=c(0,0.05), breaks=c(0,0.01,0.02,0.03,0.04,0.05), labels=c('0.0','1.0','2.0','3.0','4.0','5.0')) + labs(x='', y='Detection (%)')
p.SingleAndCoDetectionPercentOfRuns_NoHRVorRSV <- ggplot(subset(coParticipation.DetectionCount.fillByCount, !(ShortName %in% c('HRV/EV','RSV'))), aes(x=Name, y=Percentage, fill=Key)) + geom_bar(stat='identity') + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.35), panel.background=element_rect(color='white', fill='white')) + scale_fill_manual(values=createPaletteOfVariableLength(coParticipation.DetectionCount.fillByCount, 'Key'), name='') + scale_y_continuous(limits=c(0,0.05), breaks=c(0,0.01,0.02,0.03,0.04,0.05), labels=c('0.0','1.0','2.0','3.0','4.0','5.0')) + labs(x='', y='Detection (%)')
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal)
ggplot(subset(coParticipation.DetectionCount.fillByCount, !(ShortName %in% c('HRV/EV','RSV'))), aes(x=Name, y=Percentage, fill=Key)) + geom_bar(stat='identity') + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.35), panel.background=element_rect(color='white', fill='white')) + scale_fill_manual(values=createPaletteOfVariableLength(coParticipation.DetectionCount.fillByCount, 'Key'), name='') + scale_y_continuous(limits=c(0,0.05), breaks=c(0,0.01,0.02,0.03,0.04,0.05), labels=c('0.0','1.0','2.0','3.0','4.0','5.0')) + labs(x='', y='Detection (%)') + annotate('text', x=PercentOfDetectionsWithACo, y=1, label=ShortName)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=PercentOfDetectionsWithACo, y=1, label=ShortName)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=PercentOfDetectionsWithACo, y=1, label=ShortName, data=prev.pareto.all.duals)
heaD(prev.pareto.all.duals)
head(prev.pareto.all.duals)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=PercentOfDetectionsWithACo, y=1, label=Name, data=prev.pareto.all.duals)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=prev.pareto.all.duals$PercentOfDetectionsWithACo, y=1, label=prev.pareto.all.duals$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo, y=1, label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo, y=c(1, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo-0.05, y=c(1, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo-0.005, y=c(1, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo-0.005, y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name[])
subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name))])
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentDetectionsWithACo))])
subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.05, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))])
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))])
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank())
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency')
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=4) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(angle=90, hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=1, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=1), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
bug.family.Pal
bug.individual.Pal
bug.individual.Pal
elementary.block.pal <- bug.individual.Pal
bug.individual.Pal[Adeno]
bug.individual.Pal[1]
bug.individual.Pal[8]
bug.individual.Pal[16]
elementary.block.pal <- bug.individual.Pal
elementary.block.pal[8] <- bug.individual.Pal[16]
elementary.block.pal
elementary.block.pal[8] <- bug.individual.Pal[16]
elementary.block.pal[16] <- bug.individual.Pal[8]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
bug.individual.Pal
elementary.block.pal
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo), subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo), -subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=bug.individual.Pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo), -subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)], size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))])
subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo)
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels <- as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels
block.labels[c(1, 3, 2, 5, 4, 8, 7, 6, 10, 9, 13, 12, 11, 16, 15, 14, 17, 18, 19)]
block.labels <- block.labels[c(1, 3, 2, 5, 4, 8, 7, 6, 10, 9, 13, 12, 11, 16, 15, 14, 17, 18, 19)]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
block.labels
elementary.block.pal
elementary.block.pal[name(elementary.block.pal)=='Adeno']
names(elementary.block.pal)
elementary.block.pal[names(elementary.block.pal)=='Adeno']
elementary.block.pal[names(elementary.block.pal) %in% c('CoV NL63','CoV HKU1','CoV OC43','CoV 229E')]
block.labels <- as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels[c(1, 3, 2, 5, 4, 8, 7, 6, 10, 9, 13, 12, 11, 16, 15, 14, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 10, 9, 13, 12, 11, 16, 15, 14, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 12, 13, 11, 16, 15, 14, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 10, 9, 13, 12, 11, 16, 15, 14, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 12, 13, 11, 14, 15, 16, 17, 18, 19)]
block.labels <- as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels <- block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 12, 13, 11, 14, 15, 16, 17, 18, 19)]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
block.labels <- as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 12, 13, 11, 14, 15, 16, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 13, 12, 11, 14, 15, 16, 17, 18, 19)]
block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19)]
block.labels <- block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19)]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
elementary.block.pal[names(elementary.block.pal) %in% c('Adeno','hMPV','HRV/EV','RSV')] <- c('#F92016','#F9F516','#1616F9','#16F9F9')
# make corons purple
elementary.block.pal[names(elementary.block.pal) %in% c('CoV NL63','CoV HKU1','CoV OC43','CoV 229E')] <- c('#E5CBEB','#DB90EB','#A83CC1','#4D015D')
# make flus blue
elementary.block.pal[names(elementary.block.pal) %in% c('FluA H3','FluA H1-09','Flu A','FluB')] <- c('#ABCEF0','#6794C1','#1469BD','#037FFA')
# make bacteria green
elementary.block.pal[names(elementary.block.pal) %in% c('B. per','C. pne', 'M. pne')] <- c('#ADE6B2','#4DB556','#1ABB28')
# make PIVs pink
elementary.block.pal[names(elementary.block.pal) %in% c('PIV1','PIV2','PIV3','PIV4')] <- c('#F6BBDA','#EA84BA','#C44287','#F9168E')
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
elementary.block.pal <- bug.individual.Pal
# reassign colors based on bug family
# make Adeno, HRV/EV, hMPV, and RSV distinct
elementary.block.pal[names(elementary.block.pal) %in% c('Adeno','hMPV','HRV/EV','RSV')] <- c('#F9F516','#1616F9','#F92016','#16F9F9')
# make corons purple
elementary.block.pal[names(elementary.block.pal) %in% c('CoV NL63','CoV HKU1','CoV OC43','CoV 229E')] <- c('#E5CBEB','#DB90EB','#A83CC1','#4D015D')
# make flus blue
elementary.block.pal[names(elementary.block.pal) %in% c('FluA H3','FluA H1-09','Flu A','FluB')] <- c('#ABCEF0','#6794C1','#1469BD','#037FFA')
# make bacteria green
elementary.block.pal[names(elementary.block.pal) %in% c('B. per','C. pne', 'M. pne')] <- c('#ADE6B2','#4DB556','#1ABB28')
# make PIVs pink
elementary.block.pal[names(elementary.block.pal) %in% c('PIV1','PIV2','PIV3','PIV4')] <- c('#F6BBDA','#EA84BA','#C44287','#F9168E')
block.labels <- as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$Name)[order(as.character(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7)$PercentOfDetectionsWithACo))]
block.labels <- block.labels[c(1, 3, 2, 5, 4, 7, 8, 6, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19)]
ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
p.PercentOfDetectionsWithACoDetectionFrequency <- ggplot(subset(prev.pareto.all.duals, PercentOfDetectionsWithACo < 0.7), aes(x=PercentOfDetectionsWithACo, fill=ShortName)) + geom_histogram(binwidth=0.05) + scale_fill_manual(values=elementary.block.pal, guide=FALSE) + annotate('text',x=c(0.1, 0.15, 0.15, 0.2, 0.2, 0.25, 0.25, 0.25, 0.3, 0.3, 0.35, 0.35, 0.35, 0.4, 0.4, 0.4, 0.45, 0.5, 0.55), y=c(0.5, 0.5, 1.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 0.5, 1.5, 2.5, 0.5, 1.5, 2.5, 0.5, 0.5, 0.5), label=block.labels, size=6) + theme(plot.title=element_text(hjust=0.5),text=element_text(size=22, face='bold'), axis.text=element_text(size=22, color='black', face='bold'), axis.text.x=element_text(hjust=0.5, vjust=0.5), legend.position='bottom', panel.background=element_rect(color='transparent', fill='white'), panel.grid=element_blank()) + labs(x='Percent of Detections with a Co-Detection (%)', y='Frequency') + scale_x_continuous(breaks=c(0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45,0.5,0.55), labels=c('10','15','20','25','30','35','40','45','50','55'))
